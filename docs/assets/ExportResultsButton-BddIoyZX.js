import{u as E,R as p,j as P,g as S,a as u,w as k}from"./index-Db_CgbEJ.js";const T=({tournamentId:d})=>{const{teams:m,games:_,schedules:h}=E(),[e,x]=p.useState({});p.useEffect(()=>{const s=localStorage.getItem("resultsOverrides");s&&x(JSON.parse(s))},[]);const b=()=>{const s=h.find(o=>o.tournamentId===d),l=s?s.rounds:5,{sortedTeams:c,resultsMatrix:n}=S(m,_,s,e,l);if(!c.length){alert("No results to export.");return}const w=["Team #","Team Name",...Array.from({length:l},(o,t)=>[`R${t+1} W/L`,`R${t+1} Points`,`R${t+1} Hands`,`R${t+1} Boston`]).flat(),"Wins","Points","Hands","Bostons"],R=c.map(o=>{const t=String(o.id);return[o.teamNumber||t,o.name||"",...Array.from({length:l},(y,g)=>{const r=g+1,a=n[t][r]||{wl:"",points:0,hands:0,boston:0};return[e[`${t}_${r}_wl`]??a.wl,e[`${t}_${r}_points`]??a.points,e[`${t}_${r}_hands`]??a.hands,e[`${t}_${r}_boston`]??a.boston]}).flat(),n[t].totalPoints.wins??0,n[t].totalPoints.points??0,n[t].totalPoints.hands??0,n[t].totalPoints.boston??0]}),$=[w,...R],f=u.aoa_to_sheet($),i=u.book_new();u.book_append_sheet(i,f,"Results"),k(i,`tournament_results_${d}.xlsx`)};return P.jsx("button",{onClick:b,style:{padding:"8px 16px",background:"#2563eb",color:"white",border:"none",borderRadius:4,cursor:"pointer"},children:"Export Results to Excel"})};export{T as default};
